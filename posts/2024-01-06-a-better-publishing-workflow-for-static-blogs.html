<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width, initial-scale=1"/><meta charSet="utf-8"/><title>A better publishing workflow for static blogs | Garrit&#x27;s Notes</title><meta name="Description" content="Generalist software developer writing about scalable infrastructure, fullstack development and DevOps practices."/><link rel="icon" type="image/svg+xml" href="/favicon.svg"/><link rel="manifest" href="/site.webmanifest"/><link rel="webmention" href="https://webmention.io/garrit.xyz/webmention"/><link rel="pingback" href="https://webmention.io/garrit.xyz/xmlrpc"/><meta name="next-head-count" content="8"/><link rel="preload" href="/_next/static/css/f523f3a6124c7e9a.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/f523f3a6124c7e9a.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-5429a50ba5373c56.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-e24b4219d45d8163.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-79c931a4d8897bd8.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/630-04868eb325fdf1e9.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/posts/%5Bpost%5D-acc4cccb9bd6e148.js" defer="" crossorigin=""></script><script src="/_next/static/72hA5ZGlj_tvOZtvbFNsV/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/72hA5ZGlj_tvOZtvbFNsV/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><section class="layout"><header class="header"><nav class="nav" role="navigation" aria-label="main navigation"><div class="header__container"><a href="/" class="header__container__logo">Garrit&#x27;s Notes</a></div><ul class="header__links"><li><a href="/posts">Blog</a></li><li><a href="/contact">Contact</a></li><li><a href="/links">More ...</a></li></ul></nav></header><div class="content"><article class="page h-entry"><div class="page__info"><h1 class="p-name">A better publishing workflow for static blogs</h1><time class="page__info__date">Jan 06 2024</time><p class="tag-list"><a href="/posts?tags=guide">#<!-- -->guide</a><a href="/posts?tags=note">#<!-- -->note</a><a href="/posts?tags=meta">#<!-- -->meta</a><a href="/posts?tags=writing">#<!-- -->writing</a><a href="/posts?tags=web">#<!-- -->web</a><a href="/posts?tags=github">#<!-- -->github</a><a href="/posts?tags=tech">#<!-- -->tech</a></p></div><div class="page__body e-content"><p>In my <a href="/posts/2023-12-23-100daystooffload-i-made-it">post</a> celebrating the completion of my <code>#100DaysToOffload</code> challenge, I teased that &quot;I built myself a handy script that turns the contents of a GitHub issue into a pull request, ready to be merged as a blog post&quot;. I didn&#x27;t believe this was such a big deal, but a couple of readers actually reached out to me to ask about this.</p>
<p>First, some background. My site is built using a static site generator (not that it matters, but I use <a href="https://nextjs.org/">Next.js</a>). The beauty of using a SSG is that every blog post is literally just a markdown file in <a href="https://github.com/garritfra/garrit.xyz/tree/main/content/posts">a directory</a>.</p>
<h2 id="the-story-so-far">The story so far</h2>
<p>Before coming up with an automation, I had to</p>
<ol>
<li>Copy an older post to a new file</li>
<li>Rename the file</li>
<li>Fix the metadata/frontmatter</li>
<li>Delete the contents of the post</li>
<li><strong>Write the actual post</strong></li>
<li>Commit the file</li>
</ol>
<p>Putting out content on my blog involved quite a bit of friction. I felt like there was a barrier between my thoughts and the blog.</p>
<h2 id="the-solution">The solution</h2>
<p>I&#x27;ve been looking into how I could solve this issue for quite some time. I even had thoughts to build a custom blogging backend that would commit files to the <a href="https://github.com/garritfra/garrit.xyz">repository</a>, which is of course quite silly.</p>
<p>But then it struck me: GitHub issues fully support markdown! The idea was born:</p>
<ol>
<li>Open an issue in the repository of this blog</li>
<li>Write the post</li>
<li>Kick off an automation that takes the content of the issue and dumps it in a new file</li>
<li>Create a pull request to generate a preview of the post</li>
<li>Merge the PR once I&#x27;m done reviewing the post</li>
</ol>
<h2 id="so,-how-does-the-automation-work?">So, how does the automation work?</h2>
<p>The magic lies in <a href="https://github.com/garritfra/garrit.xyz/blob/main/.github/workflows/publish_via_issue.yaml">this GitHub Action</a>. It is kicked off whenever the <code>action:publish</code> label is added to an issue.</p>
<p>If for some reason this link will not be there anymore in the future, this is the action as of the time of writing:</p>
<details>
<summary>Expand me!</summary>
<pre><code class="language-yaml">on:
  issues:
    types: [labeled]
  
name: Publish issue as post
jobs:
  publish-issue:
    if: github.event.label.name == &#x27;action:publish&#x27;
    runs-on: ubuntu-latest
    env:
      POST_BODY: &#x27;${{ github.event.issue.body }}&#x27;
    steps:
      - uses: actions/checkout@v4
      - name: Create commits
        run: |
          export POST_DATE=$(date +&quot;%Y-%m-%d&quot;)
          export POST_TITLE=&quot;${{ github.event.issue.title }}&quot;
          export POST_TAGS=$(echo &quot;${{ join(github.event.issue.labels.*.name, &#x27;, &#x27;) }}&quot; | grep -o &#x27;tag:[^,]*&#x27; | cut -d: -f2- | paste -sd &quot; &quot; - | sed &#x27;s/ /, /g&#x27;)
          export FILE_TITLE=$(printf &quot;$POST_TITLE&quot; | tr -cs &#x27;[:alnum:]&#x27; &#x27;-&#x27; | tr &#x27;A-Z&#x27; &#x27;a-z&#x27; | sed &#x27;s/--/-/g&#x27; | sed &#x27;s/^-\|-$//g&#x27;)
          export FILE_NAME=&quot;$POST_DATE-$FILE_TITLE.md&quot;
          export FULL_PATH=&quot;content/posts/$FILE_NAME&quot;
          git config user.name &#x27;Publish Bot&#x27;
          git config user.email &#x27;publish-bot@github.com&#x27;

          cat &lt;&lt; EOF &gt; $FULL_PATH
          ---
          title: &quot;$POST_TITLE&quot;
          date: &quot;$POST_DATE&quot;
          tags: &quot;$POST_TAGS&quot;
          ---

          EOF

          echo &quot;$POST_BODY&quot; &gt;&gt; $FULL_PATH

          git add $FULL_PATH
          git commit -m &quot;Publish $POST_TITLE&quot;

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          title: &quot;New Post: ${{ github.event.issue.title }}&quot;
          body: &quot;Closes #${{ github.event.issue.number }}.\n\n This PR has been generated automatically.&quot;
      - uses: actions-ecosystem/action-remove-labels@v1
        with:
          labels: action:publish
</code></pre>
</details>
<p>So, when I&#x27;m done writing the post, I simply label the issue as <code>action:publish</code>, and the action turns it into a new file, commits it and ultimately opens a PR for me to review. You can see this in action by looking at <a href="https://github.com/garritfra/garrit.xyz/issues/432">the issue for this post</a>. The action also handles tags for blog posts. You can see that there are a bunch of labels on the issues that correspond to the tags of this post.</p>
<p>One additional benefit of using a static site generator is that I can generate a preview site for each pull request. So, once I&#x27;m done writing and the pull request is generated, I can just wait for Netlify to build the preview to read the blog post as if it is published to the site! This is very helpful for spotting typos or formatting issues, especially if I&#x27;m writing a post on my phone.</p>
<h2 id="further-improvements">Further improvements</h2>
<p>There are two things the current setup is lacking:</p>
<p>Firstly, GitHub doesn&#x27;t really highlight typos when writing an issue. I&#x27;m sure there are ways to address this post-publish, I just didn&#x27;t get around to doing that yet.</p>
<p>Secondly, there&#x27;s no sustainable way to add images to the repository this way. I have an <a href="https://github.com/garritfra/garrit.xyz/tree/main/public/assets">assets directory</a> where I put all my images for blog posts. You can paste images directly into the issue, which is really handy, but that generates a permalink on a GitHub CDN, somewhere that I don&#x27;t control. For the future, it would be nice to teach the GH action to take these images and dump them into the asset directory.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Using this workflow, I can pump out ideas whenever and whereever I feel like it. It drastically reduced the time from idea to written article, which helps me organize my thoughts a lot better. I also frequently create drafts for things I want to write about but is not fully fleshed out yet.</p><p class="horizontal-list"><button>üíåÔ∏è Reply via E-Mail</button><button>üîó Share</button><button>‚úèÔ∏è Fix Typo</button></p><hr/><h2>Continue Reading</h2><div><div class="blog__list__post"><time class="blog__list__post__date">Jan 18 2024</time><br/><a href="/posts/2024-01-18-cost-per-request">Cost per Request</a></div><div class="blog__list__post"><time class="blog__list__post__date">Jan 05 2024</time><br/><a href="/posts/2024-01-05-greg-the-developer">Greg, the Developer</a></div><div class="blog__list__post"><time class="blog__list__post__date">Dec 28 2023</time><br/><a href="/posts/2023-12-28-linkdump-2">Linkdump #2</a></div><div class="blog__list__post"><time class="blog__list__post__date">Dec 23 2023</time><br/><a href="/posts/2023-12-23-100daystooffload-i-made-it">#100DaysToOffload: I made it!</a></div><div class="blog__list__post"><time class="blog__list__post__date">Dec 22 2023</time><br/><a href="/posts/2023-12-22-10-000-hours">10.000 Hours</a></div></div></div></article></div><footer class="footer"><div class="footer__content"><h3>Links of Interest</h3><a href="/rss.xml">RSS Feed</a><br/><a href="/todo">Todo List</a><br/><a href="https://keys.openpgp.org/vks/v1/by-fingerprint/2218337E54AA1DBE207B404DBB54AF7EB0939F3D">PGP Key</a><br/><a href="/guestbook">Guestbook</a><br/><a href="/blogroll">Blogroll</a><br/><a href="/ctf">Capture the Flag</a><h3>Elsewhere</h3><a href="https://github.com/garritfra" rel="me">Github</a><br/><a href="https://www.linkedin.com/in/garritfranke/">LinkedIn</a><br/><a href="https://fosstodon.org/@garritfra">Mastodon (ActivityPub)</a><br/><a href="/contact">Contact</a></div><a href="https://www.buymeacoffee.com/garrit" target="_blank"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a tea&amp;emoji=&amp;slug=garrit&amp;button_colour=FFB300&amp;font_colour=000000&amp;font_family=Cookie&amp;outline_colour=000000&amp;coffee_colour=ffffff"/></a><p>üëª Proud member of <a target="_blank" href="https://darktheme.club/">darktheme.club</a> <!-- -->üëª</p><p>¬© 2018-<!-- -->2024<!-- --> Garrit Franke<br/><a href="/privacy">Privacy</a> |<!-- --> <a target="_blank" href="https://github.com/garritfra/garrit.xyz">Source Code</a></p></footer></section></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"post":{"slug":"2024-01-06-a-better-publishing-workflow-for-static-blogs","markdownBody":"\nIn my [post](/posts/2023-12-23-100daystooffload-i-made-it) celebrating the completion of my `#100DaysToOffload` challenge, I teased that \"I built myself a handy script that turns the contents of a GitHub issue into a pull request, ready to be merged as a blog post\". I didn't believe this was such a big deal, but a couple of readers actually reached out to me to ask about this.\r\n\r\nFirst, some background. My site is built using a static site generator (not that it matters, but I use [Next.js](https://nextjs.org/)). The beauty of using a SSG is that every blog post is literally just a markdown file in [a directory](https://github.com/garritfra/garrit.xyz/tree/main/content/posts). \r\n\r\n## The story so far\r\n\r\nBefore coming up with an automation, I had to\r\n\r\n1. Copy an older post to a new file\r\n2. Rename the file\r\n3. Fix the metadata/frontmatter\r\n4. Delete the contents of the post\r\n5. **Write the actual post**\r\n6. Commit the file\r\n\r\nPutting out content on my blog involved quite a bit of friction. I felt like there was a barrier between my thoughts and the blog.\r\n\r\n## The solution\r\n\r\nI've been looking into how I could solve this issue for quite some time. I even had thoughts to build a custom blogging backend that would commit files to the [repository](https://github.com/garritfra/garrit.xyz), which is of course quite silly.\r\n\r\nBut then it struck me: GitHub issues fully support markdown! The idea was born:\r\n\r\n1. Open an issue in the repository of this blog\r\n2. Write the post\r\n3. Kick off an automation that takes the content of the issue and dumps it in a new file\r\n4. Create a pull request to generate a preview of the post\r\n5. Merge the PR once I'm done reviewing the post\r\n\r\n## So, how does the automation work?\r\n\r\nThe magic lies in [this GitHub Action](https://github.com/garritfra/garrit.xyz/blob/main/.github/workflows/publish_via_issue.yaml). It is kicked off whenever the `action:publish` label is added to an issue.\r\n\r\nIf for some reason this link will not be there anymore in the future, this is the action as of the time of writing:\r\n\r\n\u003cdetails\u003e\r\n\u003csummary\u003eExpand me!\u003c/summary\u003e\r\n\r\n```yaml\r\non:\r\n  issues:\r\n    types: [labeled]\r\n  \r\nname: Publish issue as post\r\njobs:\r\n  publish-issue:\r\n    if: github.event.label.name == 'action:publish'\r\n    runs-on: ubuntu-latest\r\n    env:\r\n      POST_BODY: '${{ github.event.issue.body }}'\r\n    steps:\r\n      - uses: actions/checkout@v4\r\n      - name: Create commits\r\n        run: |\r\n          export POST_DATE=$(date +\"%Y-%m-%d\")\r\n          export POST_TITLE=\"${{ github.event.issue.title }}\"\r\n          export POST_TAGS=$(echo \"${{ join(github.event.issue.labels.*.name, ', ') }}\" | grep -o 'tag:[^,]*' | cut -d: -f2- | paste -sd \" \" - | sed 's/ /, /g')\r\n          export FILE_TITLE=$(printf \"$POST_TITLE\" | tr -cs '[:alnum:]' '-' | tr 'A-Z' 'a-z' | sed 's/--/-/g' | sed 's/^-\\|-$//g')\r\n          export FILE_NAME=\"$POST_DATE-$FILE_TITLE.md\"\r\n          export FULL_PATH=\"content/posts/$FILE_NAME\"\r\n          git config user.name 'Publish Bot'\r\n          git config user.email 'publish-bot@github.com'\r\n\r\n          cat \u003c\u003c EOF \u003e $FULL_PATH\r\n          ---\r\n          title: \"$POST_TITLE\"\r\n          date: \"$POST_DATE\"\r\n          tags: \"$POST_TAGS\"\r\n          ---\r\n\r\n          EOF\r\n\r\n          echo \"$POST_BODY\" \u003e\u003e $FULL_PATH\r\n\r\n          git add $FULL_PATH\r\n          git commit -m \"Publish $POST_TITLE\"\r\n\r\n      - name: Create Pull Request\r\n        uses: peter-evans/create-pull-request@v5\r\n        with:\r\n          title: \"New Post: ${{ github.event.issue.title }}\"\r\n          body: \"Closes #${{ github.event.issue.number }}.\\n\\n This PR has been generated automatically.\"\r\n      - uses: actions-ecosystem/action-remove-labels@v1\r\n        with:\r\n          labels: action:publish\r\n```\r\n\r\n\u003c/details\u003e\r\n\r\nSo, when I'm done writing the post, I simply label the issue as `action:publish`, and the action turns it into a new file, commits it and ultimately opens a PR for me to review. You can see this in action by looking at [the issue for this post](https://github.com/garritfra/garrit.xyz/issues/432). The action also handles tags for blog posts. You can see that there are a bunch of labels on the issues that correspond to the tags of this post.\r\n\r\nOne additional benefit of using a static site generator is that I can generate a preview site for each pull request. So, once I'm done writing and the pull request is generated, I can just wait for Netlify to build the preview to read the blog post as if it is published to the site! This is very helpful for spotting typos or formatting issues, especially if I'm writing a post on my phone.\r\n\r\n\r\n## Further improvements\r\n\r\nThere are two things the current setup is lacking:\r\n\r\nFirstly, GitHub doesn't really highlight typos when writing an issue. I'm sure there are ways to address this post-publish, I just didn't get around to doing that yet.\r\n\r\nSecondly, there's no sustainable way to add images to the repository this way. I have an [assets directory](https://github.com/garritfra/garrit.xyz/tree/main/public/assets) where I put all my images for blog posts. You can paste images directly into the issue, which is really handy, but that generates a permalink on a GitHub CDN, somewhere that I don't control. For the future, it would be nice to teach the GH action to take these images and dump them into the asset directory.\r\n\r\n## Conclusion\r\n\r\nUsing this workflow, I can pump out ideas whenever and whereever I feel like it. It drastically reduced the time from idea to written article, which helps me organize my thoughts a lot better. I also frequently create drafts for things I want to write about but is not fully fleshed out yet.\n","frontmatter":{"title":"A better publishing workflow for static blogs","date":"2024-01-06","tags":"guide, note, meta, writing, web, github, tech"},"tags":["guide","note","meta","writing","web","github","tech"]},"recommendedPosts":[{"slug":"2024-01-18-cost-per-request","frontmatter":{"title":"Cost per Request","date":"2024-01-18","tags":"infrastructure, aws, note, opinion, devops, tech"},"tags":["infrastructure","aws","note","opinion","devops","tech"]},{"slug":"2024-01-05-greg-the-developer","frontmatter":{"title":"Greg, the Developer","date":"2024-01-05","tags":"note, tech, fun, shortstory, writing, programming, practices, devops"},"tags":["note","tech","fun","shortstory","writing","programming","practices","devops"]},{"slug":"2023-12-28-linkdump-2","frontmatter":{"title":"Linkdump #2","date":"2023-12-28","tags":"note, tech, programming, linkdump"},"tags":["note","tech","programming","linkdump"]},{"slug":"2023-12-23-100daystooffload-i-made-it","frontmatter":{"title":"#100DaysToOffload: I made it!","date":"2023-12-23","tags":"100DaysToOffload, note, learnings, meta, writing"},"tags":["100DaysToOffload","note","learnings","meta","writing"]},{"slug":"2023-12-22-10-000-hours","frontmatter":{"title":"10.000 Hours","date":"2023-12-22","tags":"100DaysToOffload, note, learnings, books, tech, programming"},"tags":["100DaysToOffload","note","learnings","books","tech","programming"]}]},"__N_SSG":true},"page":"/posts/[post]","query":{"post":"2024-01-06-a-better-publishing-workflow-for-static-blogs"},"buildId":"72hA5ZGlj_tvOZtvbFNsV","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>